<!DOCTYPE html>  
<html lang="en">  
<head>  
    <meta charset="UTF-8">  
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">  
    <title>Brain Arcade v6: Ultimate Edition</title>  
    <link rel="manifest" href="manifest.json">
    <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@500;700;900&family=Poppins:wght@400;600&display=swap" rel="stylesheet">  
    <style>  
        :root {  
            --bg-dark: #05050a;  
            --cyan: #00f2ea;  
            --purple: #bf00ff;  
            --font-head: 'Orbitron', sans-serif;  
            --font-body: 'Poppins', sans-serif;  
        }  
        body { margin: 0; font-family: var(--font-body); background-color: var(--bg-dark); color: #fff; overflow: hidden; height: 100vh; }  

        /* Background Effects */
        .nebula-bg { position: fixed; top: 0; left: 0; width: 100vw; height: 100%; z-index: -2; background: radial-gradient(circle at 50% 50%, #1a0b2e, #05050a 80%); }  
        .star-field { position: fixed; top: 0; left: 0; width: 100%; height: 100%; z-index: -1; opacity: 0.6; background-image: radial-gradient(2px 2px at 40% 40%, rgba(255,255,255,0.8), transparent); background-size: 300px 300px; animation: drift 60s linear infinite; }  
        @keyframes drift { from { background-position: 0 0; } to { background-position: 0 300px; } }  
        
        /* Animations */
        @keyframes float { 0% {transform:translateY(0px);} 50% {transform:translateY(-10px);} 100% {transform:translateY(0px);} }  
        .float-anim { animation: float 3s ease-in-out infinite; }  

        /* Layout */
        #app { width: 100vw; height: 100vh; display: flex; flex-direction: column; align-items: center; justify-content: center; position: relative; }  
        h1 { font-family: var(--font-head); font-size: 2.8rem; margin: 10px 0; background: linear-gradient(to right, var(--cyan), var(--purple)); -webkit-background-clip: text; -webkit-text-fill-color: transparent; text-shadow: 0px 0px 30px rgba(191, 0, 255, 0.5); text-align: center; }  

        /* Menu Grid */
        /* MERGE NOTE: Padding increased to 120px to accommodate Chill Button */
        .menu-scroll { width: 100%; flex: 1; overflow-y: auto; display: flex; flex-direction: column; align-items: center; padding-bottom: 120px; }  
        .menu-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(135px, 1fr)); gap: 15px; width: 100%; max-width: 500px; padding: 10px; box-sizing: border-box; }  
        .game-card { background: rgba(255,255,255,0.05); border: 1px solid rgba(255,255,255,0.1); padding: 15px; border-radius: 16px; text-align: center; cursor: pointer; transition: 0.2s; backdrop-filter: blur(5px); box-shadow: 0 4px 15px rgba(0,0,0,0.4); }  
        .game-card:active { transform: scale(0.96); background: rgba(255,255,255,0.12); }  
        .game-card h3 { margin: 0; font-size: 0.9rem; color: var(--cyan); font-family: var(--font-head); }  
        .hs-label { font-size: 0.6rem; color: #aaa; margin-top: 8px; display: block; font-weight: bold; }  
        .hs-val { color: #fff; font-size: 1.1rem; font-weight: bold; font-family: var(--font-head); text-shadow: 0 0 10px rgba(255,255,255,0.3); }  

        /* --- STICKY FOOTER & FLOATING CHILL BUTTON --- */
        .sticky-footer {
            position: absolute;
            bottom: 30px;
            left: 0; 
            width: 100%;
            pointer-events: none; /* Let clicks pass through empty space */
            z-index: 50;
            display: flex;
            justify-content: center;
            align-items: center;
        }

        @keyframes zero-g {
            0% { transform: translate(0, 0) rotate(0deg); }
            25% { transform: translate(8px, -12px) rotate(3deg); }
            50% { transform: translate(0, -20px) rotate(0deg); }
            75% { transform: translate(-8px, -12px) rotate(-3deg); }
            100% { transform: translate(0, 0) rotate(0deg); }
        }

        .chill-btn {
            pointer-events: auto;
            width: 75px;
            height: 75px;
            border-radius: 50%;
            background: rgba(10, 10, 20, 0.85);
            border: 2px solid var(--cyan);
            box-shadow: 0 0 30px rgba(0, 242, 234, 0.3), inset 0 0 15px rgba(0, 242, 234, 0.2);
            color: var(--cyan);
            font-family: var(--font-head);
            font-size: 0.75rem;
            font-weight: 900;
            text-align: center;
            line-height: 1.2;
            letter-spacing: 1px;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            cursor: pointer;
            backdrop-filter: blur(8px);
            transition: all 0.3s ease;
            animation: zero-g 6s ease-in-out infinite;
        }

        .chill-btn:active { transform: scale(0.9) !important; box-shadow: 0 0 50px rgba(0, 242, 234, 0.8); background: rgba(0, 242, 234, 0.1); }
        .chill-btn:hover { box-shadow: 0 0 40px rgba(0, 242, 234, 0.5); text-shadow: 0 0 10px var(--cyan); }

        /* Game Container (Iframe) */
        #game-layer { position: absolute; top: 0; left: 0; width: 100%; height: 100%; background: #05050a; z-index: 100; display: none; }
        iframe { width: 100%; height: 100%; border: none; }
    </style>
</head>  
<body>  
<div id="app">  
    <div class="nebula-bg"></div>  
    <div class="star-field"></div>  
            
    <div style="width:100%; max-width:500px; margin-top:10px; margin-bottom:15px; padding:0 20px; box-sizing:border-box; text-align: center;">
            <p style="color:#FFD700; font-family:var(--font-head); font-size:0.9rem; margin:0 0 8px 0; text-shadow:0 0 10px rgba(255, 215, 0, 0.5); letter-spacing: 1px;">
                Install üëá apps now
            </p>
            <div style="display:flex; gap:10px;">
                <button id="install-btn" class="float-anim" style="display:none; flex:1; align-items:center; justify-content:center; padding:8px 10px; background: linear-gradient(45deg, #00f2ea, #bf00ff); box-shadow: 0 4px 15px rgba(0, 242, 234, 0.3); border:none; border-radius:20px; color:#fff; font-family:var(--font-head); font-weight: 900; font-size:0.75rem; transition:0.2s; cursor:pointer;">
                    <span style="font-size:1.2rem; margin-right:5px;">‚¨áÔ∏è</span> INSTALL APP
                </button>
                <a href="https://twolife-v1.github.io/my/" target="_blank" rel="noopener noreferrer" class="float-anim" style="flex:1; text-decoration:none; display:flex; align-items:center; justify-content:center; padding:8px 10px; background: linear-gradient(45deg, #FFD700, #FFA500); box-shadow: 0 4px 15px rgba(255, 215, 0, 0.3); border:none; border-radius:20px; color:#05050a; font-family:var(--font-head); font-weight: 900; font-size:0.75rem; transition:0.2s;">
                   <img src="icon-512.png" style="height:24px; width:24px; margin-right:8px; border-radius:5px; vertical-align:middle;"> WaktuSolat
                </a>
                <a href="https://pipahcookiesapp.github.io/com/" target="_blank" rel="noopener noreferrer" class="float-anim" style="flex:1; text-decoration:none; display:flex; align-items:center; justify-content:center; padding:8px 10px; background: linear-gradient(45deg, #FFD700, #FFA500); box-shadow: 0 4px 15px rgba(255, 215, 0, 0.3); border:none; border-radius:20px; color:#05050a; font-family:var(--font-head); font-weight: 900; font-size:0.75rem; transition:0.2s; animation-delay:0.3s;">
                   <img src="icon.png" style="height:24px; width:24px; margin-right:8px; border-radius:5px; vertical-align:middle;"> PipahCookies
                </a>
            </div>
    </div>

    <div style="padding: 10px 0;">  
        <h1>BRAIN<br>ARCADE</h1>  
        <p style="text-align:center; opacity: 0.6; font-size: 0.9rem; margin: 0; letter-spacing: 3px; color:var(--cyan);">PLATFORM HUB</p>  
    </div>  

    <div class="menu-scroll">  
        <div class="menu-grid">  
            <div class="game-card float-anim" onclick="launchGame('cosmic.html')" style="border-top: 3px solid #ff00ff; box-shadow: 0 0 20px rgba(255,0,255,0.3); grid-column: span 2;">  
                <h3 style="color:#ff00ff; font-size: 1.2rem;">COSMIC GLIDE 3D</h3>  
                <span class="hs-label">HIGH SCORE</span><span id="hs-glider" class="hs-val">0</span>  
            </div>  
            <div class="game-card float-anim" onclick="launchGame('arcade.html?game=memory')" style="border-top: 3px solid #4facfe; animation-delay: 0.1s;">  
                <h3>MEMORY MATRIX</h3> <span class="hs-label">BEST</span><span id="hs-memory" class="hs-val">0</span>  
            </div>  
            <div class="game-card float-anim" onclick="launchGame('arcade.html?game=math')" style="border-top: 3px solid #bf00ff; animation-delay: 0.2s;">  
                <h3>QUICK MATH</h3> <span class="hs-label">BEST</span><span id="hs-math" class="hs-val">0</span>  
            </div>  
            <div class="game-card float-anim" onclick="launchGame('arcade.html?game=color')" style="border-top: 3px solid #f1c40f; animation-delay: 0.3s;">  
                <h3>COLOR TRAP</h3> <span class="hs-label">BEST</span><span id="hs-color" class="hs-val">0</span>  
            </div>  
            <div class="game-card float-anim" onclick="launchGame('arcade.html?game=odd')" style="border-top: 3px solid #fff; animation-delay: 0.4s;">  
                <h3>ODD ONE OUT</h3> <span class="hs-label">BEST</span><span id="hs-odd" class="hs-val">0</span>  
            </div>  
            <div class="game-card float-anim" onclick="launchGame('arcade.html?game=order')" style="border-top: 3px solid #4facfe; animation-delay: 0.5s;">  
                <h3>ORDER CHAOS</h3> <span class="hs-label">BEST</span><span id="hs-order" class="hs-val">0</span>  
            </div>  
            <div class="game-card float-anim" onclick="launchGame('arcade.html?game=dash')" style="border-top: 3px solid #00e676; animation-delay: 0.6s;">  
                <h3>DIRECTION DASH</h3> <span class="hs-label">BEST</span><span id="hs-dash" class="hs-val">0</span>  
            </div>  
            <div class="game-card float-anim" onclick="launchGame('arcade.html?game=reflex')" style="border-top: 3px solid #ff0080; animation-delay: 0.7s;">  
                <h3>RAPID REFLEX</h3> <span class="hs-label">BEST</span><span id="hs-reflex" class="hs-val">0</span>  
            </div>  
            <div class="game-card float-anim" onclick="launchGame('arcade.html?game=runner')" style="border-top: 3px solid #bf00ff; animation-delay: 0.8s;">  
                <h3>ROCKET RUN</h3> <span class="hs-label">BEST</span><span id="hs-runner" class="hs-val">0</span>  
            </div>  
        </div>  
    </div>  

    <div class="sticky-footer">
        <div class="chill-btn" onclick="launchInternalChill()" title="Chill Mode">
            GET<br>CALM
        </div>
    </div>

    <div id="game-layer">
        <iframe id="game-frame" src=""></iframe>
    </div>
</div>  

<script>
    // --- 1. INTERNAL CHILL GAME SOURCE (Embedded) ---
    const chillGameCode = `
    <!DOCTYPE html>
    <html lang="en">
    <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
        <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@500;700&family=Poppins:wght@400&display=swap" rel="stylesheet">
        <style>
            body { 
                margin: 0; background: radial-gradient(circle at 50% 50%, #1a0b2e, #05050a 80%); 
                font-family: 'Orbitron', sans-serif; color: white; height: 100vh; overflow: hidden; 
                display: flex; flex-direction: column; align-items: center; justify-content: center;
                user-select: none; -webkit-tap-highlight-color: transparent;
            }
            .header-ui { position: absolute; top: 20px; left: 20px; z-index: 100; }
            .back-btn { 
                background: rgba(0,0,0,0.5); border: 1px solid #00f2ea; color: #00f2ea;
                width: 40px; height: 40px; border-radius: 50%; display: flex; align-items: center; justify-content: center;
                font-size: 1.2rem; cursor: pointer; backdrop-filter: blur(5px);
            }
            #instruction { font-size: 1.8rem; letter-spacing: 2px; text-shadow: 0 0 10px #00f2ea; margin-bottom: 40px; text-align: center; color: #00f2ea; }
            #breathing-circle {
                width: 160px; height: 160px; border-radius: 50%;
                background: rgba(255,255,255,0.05); border: 4px solid rgba(0, 242, 234, 0.4);
                display: flex; justify-content: center; align-items: center;
                box-shadow: 0 0 30px rgba(0, 242, 234, 0.1); cursor: pointer;
                transition: transform 0.05s linear;
            }
            .pulse { animation: p 2s infinite; }
            @keyframes p { 0% {transform:scale(1); border-color: rgba(0,242,234,0.4);} 50% {transform:scale(1.05); border-color: rgba(191,0,255,0.8);} 100% {transform:scale(1); border-color: rgba(0,242,234,0.4);} }
            #center-icon { font-size: 5rem; filter: drop-shadow(0 0 10px rgba(0,242,234,0.5)); pointer-events: none; }
            #progress-bar { 
                position: absolute; bottom: 80px; width: 60%; height: 6px; background: #111; 
                border-radius: 10px; overflow: hidden; border: 1px solid #333;
            }
            #fill { width: 0%; height: 100%; background: linear-gradient(90deg, #00f2ea, #bf00ff); box-shadow: 0 0 10px #00f2ea; transition: width 0.5s; }
            .particle { position: absolute; width: 2px; height: 2px; background: #fff; border-radius: 50%; opacity: 0; animation: starRise 2s linear infinite; pointer-events: none; }
            @keyframes starRise { 0% {transform:translateY(50vh); opacity:0;} 20% {opacity:1;} 100% {transform:translateY(-50vh); opacity:0;} }
            .win-mode #breathing-circle { border-color: #ffd700; box-shadow: 0 0 50px #ffd700; background: rgba(255,215,0,0.1); }
            .win-mode #instruction { color: #ffd700; text-shadow: 0 0 20px #ffd700; }
        </style>
    </head>
    <body>
        <div class="header-ui">
            <div class="back-btn" onclick="quit()">‚úï</div>
        </div>
        <div id="instruction">HOLD TO CHARGE</div>
        <div id="breathing-circle" class="pulse">
            <div id="center-icon">‚öõÔ∏è</div>
        </div>
        <div id="progress-bar"><div id="fill"></div></div>
        <div id="particles"></div>

        <script>
            const audioCtx = new (window.AudioContext || window.webkitAudioContext)();
            let osc, gain;
            const txt = document.getElementById('instruction');
            const circle = document.getElementById('breathing-circle');
            const fill = document.getElementById('fill');
            let scale = 1, progress = 0, isHolding = false, anim, won = false;

            function sound(on) {
                if(on) {
                    if(audioCtx.state === 'suspended') audioCtx.resume();
                    osc = audioCtx.createOscillator();
                    gain = audioCtx.createGain();
                    osc.type = 'sine'; osc.frequency.setValueAtTime(120, audioCtx.currentTime);
                    gain.gain.setValueAtTime(0, audioCtx.currentTime);
                    gain.gain.linearRampToValueAtTime(0.2, audioCtx.currentTime + 1);
                    osc.connect(gain); gain.connect(audioCtx.destination);
                    osc.start();
                } else {
                    if(osc) {
                        gain.gain.linearRampToValueAtTime(0, audioCtx.currentTime + 0.5);
                        osc.stop(audioCtx.currentTime + 0.5);
                        osc = null;
                    }
                }
            }
            function quit() { window.parent.postMessage('close_game', '*'); }
            function loop() {
                if(isHolding) {
                    if(scale < 2.5) scale += 0.01;
                    if(osc) osc.frequency.setTargetAtTime(120 + (scale*40), audioCtx.currentTime, 0.1);
                    if(Math.random() > 0.8) spawnParticle();
                } else {
                    if(scale > 1) scale -= 0.02;
                    else scale = 1;
                }
                circle.style.transform = 'scale('+scale+')';
                if(scale > 1) requestAnimationFrame(loop);
            }
            function start(e) {
                if(won) return;
                e.preventDefault();
                isHolding = true;
                circle.classList.remove('pulse');
                txt.innerText = "INHALE...";
                sound(true);
                loop();
            }
            function end() {
                if(won) return;
                isHolding = false;
                txt.innerText = "EXHALE...";
                sound(false);
                if(scale > 2.0) {
                    progress += 20;
                    fill.style.width = progress + '%';
                    if(progress >= 100) win();
                } else {
                     setTimeout(() => { if(!isHolding) txt.innerText = "HOLD TO CHARGE"; }, 1000);
                }
            }
            function spawnParticle() {
                const p = document.createElement('div');
                p.className = 'particle';
                p.style.left = (Math.random() * 100) + 'vw';
                p.style.top = (Math.random() * 100) + 'vh';
                document.getElementById('particles').appendChild(p);
                setTimeout(() => p.remove(), 2000);
            }
            function win() {
                won = true;
                document.body.classList.add('win-mode');
                txt.innerText = "ENERGY RESTORED";
                document.getElementById('center-icon').innerText = "üí†";
                document.getElementById('progress-bar').style.opacity = 0;
            }
            circle.addEventListener('mousedown', start);
            circle.addEventListener('touchstart', start, {passive:false});
            window.addEventListener('mouseup', end);
            window.addEventListener('touchend', end);
        <\/script>
    </body>
    </html>`;

    function launchInternalChill() {
        const layer = document.getElementById('game-layer');
        const frame = document.getElementById('game-frame');
        const blob = new Blob([chillGameCode], { type: 'text/html' });
        const url = URL.createObjectURL(blob);
        frame.src = url;
        layer.style.display = 'block';
    }

    // --- STANDARD APP LOGIC ---
    if ('serviceWorker' in navigator) {
      navigator.serviceWorker.register('sw.js').catch(() => console.log('SW Skip'));
    }

    const scores = { memory:0, math:0, color:0, odd:0, order:0, dash:0, reflex:0, runner:0, glider:0 };  
    
    function loadScores() {  
        try {  
            let s = localStorage.getItem('brainArcadeV6');  
            if(s) Object.assign(scores, JSON.parse(s));  
        } catch(e) {}  
        for(let k in scores) { let e=document.getElementById(`hs-${k}`); if(e) e.innerText=scores[k]; }  
    }  

    function launchGame(url) {
        const layer = document.getElementById('game-layer');
        const frame = document.getElementById('game-frame');
        frame.src = url;
        layer.style.display = 'block';
    }

    window.addEventListener('message', function(event) {
        if(event.data === 'close_game') {
            document.getElementById('game-layer').style.display = 'none';
            document.getElementById('game-frame').src = '';
            setTimeout(loadScores, 50); 
        }
    });

    loadScores();
    
    // --- UNIVERSAL INSTALL LOGIC ---
    const isIOS = /iPhone|iPad|iPod/.test(navigator.userAgent) && !window.MSStream;
    const isInstalled = window.matchMedia('(display-mode: standalone)').matches;
    let deferredPrompt;
    const installBtn = document.getElementById('install-btn');

    window.addEventListener('beforeinstallprompt', (e) => {
        e.preventDefault();
        deferredPrompt = e;
        if(installBtn) installBtn.style.display = 'flex';
    });

    if(installBtn) {
        installBtn.addEventListener('click', async () => {
            if (deferredPrompt) {
                deferredPrompt.prompt();
                const { outcome } = await deferredPrompt.userChoice;
                deferredPrompt = null;
                installBtn.style.display = 'none';
            }
        });
    }

    if (isIOS && !isInstalled) {
        const iosMsg = document.createElement('div');
        iosMsg.style.cssText = "position:fixed; bottom:20px; left:50%; transform:translateX(-50%); width:90%; background:rgba(0,0,0,0.9); color:#fff; padding:15px; border-radius:15px; border:1px solid #bf00ff; text-align:center; font-size:0.9rem; z-index:9999; box-shadow:0 0 20px rgba(191,0,255,0.4);";
        iosMsg.innerHTML = "To install on iOS:<br>Tap <span style='font-size:1.3rem'>‚éã</span> Share &rarr; <b>Add to Home Screen</b>";
        const close = document.createElement('div');
        close.innerText = "OK";
        close.style.cssText = "margin-top:10px; color:#00f2ea; font-weight:bold; cursor:pointer; padding:5px;";
        close.onclick = () => iosMsg.remove();
        iosMsg.appendChild(close);
        document.body.appendChild(iosMsg);
    }
</script>

<script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-database-compat.js"></script>
<script>
    const firebaseConfig = {
      apiKey: "AIzaSyCYPD6eFQvtwi6CMBkAbQ1SmkWA2qtby9s",
      authDomain: "wofplay-123.firebaseapp.com",
      databaseURL: "https://wofplay-123-default-rtdb.firebaseio.com",
      projectId: "wofplay-123",
      storageBucket: "wofplay-123.firebasestorage.app",
      messagingSenderId: "716443688368",
      appId: "1:716443688368:web:6ebd08d8d3a49f1c494a75"
    };
    
    if (!firebase.apps.length) firebase.initializeApp(firebaseConfig);
    const db = firebase.database();
    
    let uid = localStorage.getItem('ba_uid');
    if (!uid) {
        uid = 'user_' + Math.floor(Math.random() * 100000);
        localStorage.setItem('ba_uid', uid);
        db.ref('stats/installs').transaction(c => (c || 0) + 1);
    }
    
    const visitRef = db.ref('stats/visits');
    visitRef.transaction(current => (current || 0) + 1);

    const isMobile = /iPhone|iPad|iPod|Android/i.test(navigator.userAgent);
    const deviceType = isMobile ? (navigator.userAgent.includes('iPhone') ? 'iPhone' : 'Android') : 'PC/Desktop';

    const myStatusRef = db.ref('status/' + uid);
    myStatusRef.onDisconnect().set({ state: 'offline', last_seen: Date.now() });
    myStatusRef.set({ state: 'online', device: deviceType, last_seen: Date.now() });
</script> 
</body>  
</html>
